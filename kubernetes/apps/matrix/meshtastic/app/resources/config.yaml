matrix:
  homeserver: https://matrix.ok8.sh
  # Modern authentication using password (recommended)
  # MMRelay will automatically create secure credentials.json on startup
  password: your_matrix_password_here  # Set your Matrix account password
  # Security: After first successful start, remove this password from the file.
  #           Linux/macOS: chmod 600 ~/.mmrelay/config.yaml
  #           Windows: restrict file access to your user (e.g., via file Properties → Security)
  #           Never commit this file with a password to version control.
  bot_user_id: "@meshtastic:ok8.sh"

  # End-to-End Encryption (E2EE) configuration
  # E2EE is automatically enabled when using password-based authentication AND E2EE dependencies are installed (Linux/macOS only)
  # NOTE: E2EE is not available on Windows due to dependency limitations
  #
  # SETUP INSTRUCTIONS:
  # 1. Install E2EE dependencies: pipx install 'mmrelay[e2e]' (Linux/macOS only)
  # 2. Set your password above and run MMRelay
  # 3. MMRelay will automatically create credentials.json with E2EE support
  # 4. For interactive setup, use: mmrelay auth login
  #
  e2ee:
  #  # Optional: When credentials.json is present, MMRelay auto-enables E2EE.
  #  # Configure this section only if you want to override defaults (e.g., store_path).
    enabled: true                        # Explicit toggle if you need to force-enable/disable (usually not needed)
    store_path: /app/encrypted-store      # Optional path for encryption keys storage

  # Message prefix customization (Meshtastic → Matrix direction)
  #prefix_enabled: true # Enable prefixes on messages from mesh (e.g., "[Alice/MyMesh]: message")
  #prefix_format: "[{long}/{mesh}]: " # Default format. Variables: {long1-20}, {long}, {short}, {mesh1-20}, {mesh}

matrix_rooms: # Needs at least 1 room & channel, but supports all Meshtastic channels
  - id: "#meshtastic:ok8.sh" # Matrix room aliases & IDs supported
    meshtastic_channel: 0

meshtastic:
  connection_type: tcp # Choose either "tcp", "serial", or "ble"
  host: meshtastic.outsideour.casa # Only used when connection is "tcp"
  meshnet_name: Your Meshnet Name # This is displayed in full on Matrix, but is truncated when sent to a Meshnet
  message_interactions: # Configure reactions and replies (both require message storage in database)
    reactions: false # Enable reaction relaying between platforms
    replies: false   # Enable reply relaying between platforms

  # Connection health monitoring configuration
  #health_check:
  #  enabled: true                    # Enable/disable periodic health checks (default: true)
  #  heartbeat_interval: 60           # Interval in seconds between health checks (default: 60)
  #                                   # Note: BLE connections use real-time disconnection detection and skip periodic checks
  #                                   # Legacy: heartbeat_interval at meshtastic level still supported but deprecated

  # Additional configuration options (commented out with defaults)
  broadcast_enabled: false # Must be set to true to enable Matrix to Meshtastic messages
  #detection_sensor: true # Must be set to true to forward messages of Meshtastic's detection sensor module
  #message_delay: 2.2 # Delay in seconds between messages sent to mesh (minimum: 2.0 due to firmware)
  #timeout: 30 # Timeout in seconds for Meshtastic operations (default: 30, library default: 300)

  # Message prefix customization (Matrix → Meshtastic direction)
  #prefix_enabled: true # Enable username prefixes on messages sent to mesh (e.g., "Alice[M]: message")
  #prefix_format: "{display5}[M]: " # Default format. See ADVANCED_CONFIGURATION.md for all variables.

logging:
  level: info
  #log_to_file: true                          # Set to true to enable file logging
  #filename: ~/.mmrelay/logs/mmrelay.log      # Default location if log_to_file is true
  #max_log_size: 10485760                     # 10 MB default if omitted
  #backup_count: 1                            # Keeps 1 backup as the default if omitted
  #color_enabled: true                        # Set to false to disable colored console output
  #rich_tracebacks: false                     # Show rich tracebacks in console output (defaults to false)

  # Component-specific debug logging (useful for troubleshooting)
  # When disabled (false or omitted), external library logs are completely suppressed
  # When enabled, you can use: true (DEBUG level) or specify level: "debug", "info", "warning", "error"
  #debug:
  #  matrix_nio: false                         # Disable matrix-nio logging (default: completely suppressed)
  #  #matrix_nio: true                         # Enable matrix-nio debug logging
  #  #matrix_nio: "warning"                    # Enable matrix-nio warning+ logging
  #  bleak: false                              # Disable BLE (bleak) logging (default: completely suppressed)
  #  meshtastic: false                         # Disable meshtastic library logging (default: completely suppressed)

#database:
#  path: ~/.mmrelay/data/meshtastic.sqlite   # Default location
#  enable_wal: true  # Enable Write-Ahead Logging for better concurrency
#  busy_timeout_ms: 5000  # Milliseconds to wait if the database is busy
#  pragmas:
#    synchronous: NORMAL
#    temp_store: MEMORY
#  msg_map: # The message map is necessary for the relay_reactions functionality. If `relay_reactions` is set to false, nothing will be saved to the message map.
#    msgs_to_keep: 500 # If set to 0, it will not delete any messages; Defaults to 500
#    wipe_on_restart: true # Clears out the message map when the relay is restarted; Defaults to False

# These are core Plugins - Note: Some plugins are experimental and some need maintenance.
plugins:
  # Global setting for all plugins: require bot mentions for commands
  #require_bot_mention: true  # Set to false to disable mention requirements for all plugins

  ping:
    active: true
    #require_bot_mention: true  # Override global setting for this plugin only
    #channels: [2,3,5] # List of channels the plugin will respond to; DMs are always processed if the plugin is active
  weather:
    active: true
    #require_bot_mention: true  # Override global setting for this plugin only
    units: imperial # Options: metric, imperial - Default is metric
    #channels: [] # Empty list, will only respond to DMs
  nodes:
    active: true
    #require_bot_mention: true  # Override global setting for this plugin only
    # Does not need to specify channels, as it's a Matrix-only plugin

#community-plugins:
#  sample_plugin:
#    active: true
#    repository: https://github.com/username/sample_plugin.git
#    tag: master
#  advanced_plugin:
#    active: false
#    repository: https://github.com/username/advanced_plugin.git
#    tag: v1.2.0

#custom-plugins:
#  my_custom_plugin:
#    active: true
#  another_custom_plugin:
#    active: false
